{% load static %}
<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>{% block title %}Quizfy - Create Quizzes Effortlessly{% endblock %}</title>
<link rel="stylesheet" href="/static/quizzes/main.css">
<script>
  const darkMode = localStorage.getItem('darkMode') === 'true';
  if (darkMode) document.documentElement.setAttribute('data-theme', 'dark');
  else document.documentElement.removeAttribute('data-theme');
</script>
</head>
<body>
<header class="topbar">
    <div class="container">
    <div class="brand"><a href="{% url 'landing' %}" style="color: inherit; text-decoration: none;">Quizfy</a></div>

    <nav class="navbar">
        <div class="nav-left">
          <button class="hamburger" id="hamburger-btn" onclick="toggleMenu()" aria-label="Toggle navigation" aria-expanded="false">
            <span class="hamburger-icon">â˜°</span>
          </button>
        </div>
      
        <div class="nav-right" id="mobile-nav">
          <!-- Close button for mobile -->
          <button class="mobile-close-btn" onclick="toggleMenu()" aria-label="Close menu">âœ•</button>
          
          {% if user.is_authenticated %}
      
            {% if user.is_staff %}
              <!-- TEACHER NAV -->
              <a href="{% url 'teacher_quizzes' %}" class="nav-link">ğŸ“š My Quizzes</a>
              <a href="{% url 'change_password' %}" class="nav-link">ğŸ”‘ Change Password</a>
              <a href="{% url 'app_logout' %}" class="btn danger">ğŸšª Logout</a>
      
            {% else %}
              <!-- STUDENT NAV -->
              <a href="{% url 'student_dashboard' %}" class="nav-link">ğŸ“Š Dashboard</a>
              <a href="{% url 'change_password' %}" class="nav-link">ğŸ”‘ Change Password</a>
              <a href="{% url 'app_logout' %}" class="btn danger">ğŸšª Logout</a>
            {% endif %}
      
          {% else %}
            <!-- PUBLIC NAV -->
            <a href="{% url 'home' %}" class="nav-link">ğŸ  Home</a>
            <a href="{% url 'teacher_login' %}" class="nav-link">ğŸ‘¨â€ğŸ« Teacher Login</a>
            <a href="{% url 'student_login' %}" class="nav-link">ğŸ‘¨â€ğŸ“ Student Login</a>
            <a href="{% url 'student_signup' %}" class="btn primary">âœ¨ Sign Up</a>
          {% endif %}
          <button class="theme-toggle" onclick="toggleTheme()" title="Toggle dark/light mode">
            <span class="theme-icon">ğŸŒ™</span> <span class="theme-text">Toggle Theme</span>
          </button>
        </div>
      </nav>
      
    </div>
    <!-- Mobile overlay -->
    <div class="mobile-overlay" id="mobile-overlay" onclick="toggleMenu()"></div>
</header>

<main class="container">
    {% if messages %}
    <div class="messages">
        {% for message in messages %}
    <div class="msg {{ message.tags }}">{{ message }}</div>
        {% endfor %}
    </div>
    {% endif %}

    {% block content %}{% endblock %}
</main>

<script>
function toggleTheme() {
  const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
  if (isDark) {
    document.documentElement.removeAttribute('data-theme');
    localStorage.setItem('darkMode', 'false');
    document.querySelector('.theme-toggle').textContent = 'ğŸŒ™';
  } else {
    document.documentElement.setAttribute('data-theme', 'dark');
    localStorage.setItem('darkMode', 'true');
    document.querySelector('.theme-toggle').textContent = 'â˜€ï¸';
  }
}
</script>
<script>
// Mobile menu toggle with smooth animations
function toggleMenu(){
  const nav = document.getElementById('mobile-nav');
  const btn = document.getElementById('hamburger-btn');
  const overlay = document.getElementById('mobile-overlay');
  if(!nav || !btn) return;
  
  const isOpen = nav.classList.toggle('open');
  btn.classList.toggle('active', isOpen);
  btn.setAttribute('aria-expanded', isOpen);
  
  // Toggle overlay
  if(overlay) overlay.classList.toggle('active', isOpen);
  
  // Prevent body scroll when menu is open
  document.body.style.overflow = isOpen ? 'hidden' : '';
  
  // Update hamburger icon
  const icon = btn.querySelector('.hamburger-icon');
  if(icon) icon.textContent = isOpen ? 'âœ•' : 'â˜°';
}

// Close menu when clicking a link
document.addEventListener('DOMContentLoaded', function(){
  // Add click listeners to nav links to close menu
  document.querySelectorAll('#mobile-nav .nav-link, #mobile-nav .btn').forEach(function(link){
    link.addEventListener('click', function(){
      if(window.innerWidth <= 600){
        toggleMenu();
      }
    });
  });

  // Staggered entrance for cards
  document.querySelectorAll('.card').forEach(function(el, idx){
    setTimeout(function(){ el.classList.add('animate-in'); }, idx * 70);
  });

  // Close mobile menu on resize to larger screens
  window.addEventListener('resize', function(){
    if(window.innerWidth > 600){
      const nav = document.getElementById('mobile-nav');
      const btn = document.getElementById('hamburger-btn');
      const overlay = document.getElementById('mobile-overlay');
      if(nav) nav.classList.remove('open');
      if(btn){
        btn.classList.remove('active');
        btn.setAttribute('aria-expanded', 'false');
        const icon = btn.querySelector('.hamburger-icon');
        if(icon) icon.textContent = 'â˜°';
      }
      if(overlay) overlay.classList.remove('active');
      document.body.style.overflow = '';
    }
  });

  // Close menu on Escape key
  document.addEventListener('keydown', function(e){
    if(e.key === 'Escape'){
      const nav = document.getElementById('mobile-nav');
      if(nav && nav.classList.contains('open')){
        toggleMenu();
      }
    }
  });
});
</script>
</body>
</html>
